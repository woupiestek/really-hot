\documentclass[csh.tex]{subfiles}
\begin{document}
\section{Cofibrations}
\hide{check reverences to cycle inclusions, as they are playing a smaller role now}

This sections introduces a new type of morphism with similar properties as fibrations and shows that they form an internal factorization system with cofibrations on $\ambient\s$ (see definition \ref{model structure}).

\begin{lemma} Acyclic fibrations and cofibrations form an internal factorization system on $\ambient\s$. \label{factorization system 1}. \end{lemma}

\begin{proof} Proposition \ref{factor1} shows that every morphism factors as a contractible morphism (see definition \ref{contractible}) following a cofibration. Acyclic fibrations are examples of contractible morphisms (see example \ref{acyclic means contractible}). Lemma \ref{Reedy} shows that contractible morphisms are acyclic cofibrations. Hence contractible morphisms and acyclic fibrations are the same class of morphism.
\end{proof}

\begin{definition} A morphism $f\of X\to Y$ is \keyword{contractible} is it has the internal left lifting property with respect to the family of cycle inclusions, which is defined as follows.

The \emph{cycle} $\cycle[n]$ is the subobject of non surjective functions of $\simplex[n]$. The $\dim$ and $\cdot$ are the same and the bases are related as follows:
\[ \base{\cycle[n]} = \set{\phi\of\base{\simplex[n]}| \exists i\of[n].\forall j\of \dom(\phi).\phi(i)\neq j } \]
The \keyword{cycle inclusion} is the monomorphism $\cycle[n]\to\simplex[n]$. The \emph{family of cycle inclusions} is the sum of all cycle inclusions $\Sigma n\of\nno.\cycle[n]\to \Sigma k\leq n\of\nno.\simplex[n]$ that exists as a morphism of $\ambient\s$.

Definition \ref{fibration} explains how lifting properties with respect to families work.
\end{definition}

\begin{example} Each cycle inclusion $\cycle[n]\to\simplex[n]$ is a cofibration because the unique face of $\simplex[n]$ not in $\cycle[n]$ is $\id_{[n]}\of[n]\to[n]$. Therefore every acyclic fibration is a contractible morphism. \label{acyclic means contractible} \end{example}

\begin{proposition} Every morphism factors as a contractible morphism following a cofibration. \label{factor1} \end{proposition}

\begin{proof} \hide{The construction is based on the fact that $\simCat$ is a \emph{Reedy category}.} 
Let $\simCat^+$ be the full subcategory of monomorphisms and $\simCat^-$ that of epimorphisms of $\simCat$ (see definition \ref{category of simplices}). For each morphism $\phi$ of $\simCat$ let $m(\phi)$ be the monic and $e(\phi)$ the epic factors.

The first step is to cover $Y$ with another simplicial set $LY$ where degeneracy is decidable.
Let $LY[n] = \Sigma i\of[n]. Y[i]\times\simCat^-(n,i)$ and for $\phi\of [m]\to [n]$ of $\simCat$ and $\tuplet{\epsilon,y}\of LY[n]$ let the following equation hold.
\[\tuplet{\epsilon,y}\cdot \phi=\tuplet{e(\epsilon\circ \phi),y\cdot m(\epsilon\circ\phi)}\]
Let $l_Y\of LY\to Y$ satisfy $l_Y\tuplet{\epsilon,y}=y\cdot\epsilon$.

The second step glues simplices of $X$ and $LY$ together into new ones.
The pair $(f,l_Y)$ stand for the morphism $X+LY\to Y$ that satisfies $(f,l_Y)(x)=f(x)$ for $x\of X$ and $(f,l_Y)(y) = l_Y(y)$ for $y\of LY$. Let $Z[n]\subseteq \Pi i\in[n].(X[i]+LY[i])^{\simCat^+(i,n)}$ consist of elements $z$ which satisfy the following conditions for all $\alpha\of [j]\to [k]$ and $\beta\of [i]\to[j]$ in $\simCat^+$.
\begin{enumerate}
\item $(f,l_Y)(z(\alpha\circ\beta)) = (f,l_Y)(z(\alpha))\cdot\beta$;
\item if $z(\alpha)\of X$ then $z(\alpha\circ\beta)\of X$;
\item if $z(\alpha)=\tuplet{\epsilon,y}\of LY$ and $\epsilon\circ\beta$ is not monic, then $z(\alpha\circ\beta)\of LY$ and $z(\alpha\circ\beta)_0$ factors through $\epsilon\circ\beta$.
\end{enumerate}
For $\phi\of[m]\to [n]$, and $z\of Z[n]$, let $z\cdot\phi$ satisfy the following equation for all $\alpha$ of $\simCat^+$.
\[ (z\cdot\phi)(\alpha) = z(m(\phi\circ\alpha))\cdot e(\phi\circ \alpha) \]
By these definitions, $Z$ is a simplicial object.

There is a morphism $g\of X\to Z$ which satisfies $g(x)(\alpha) = x\cdot\alpha$. It is a cofibration because a $z\of\base Z$ is nondegenerate and outside of the image of $g$ if and only if $z(\id_{[\dim(z)]}) = \tuplet{\id_{[\dim(z)]},y}$ for some simplex $y\of Y[\dim(z)]$. The definition of $LY$ ensures that elements with this property are nondegenerate while condition 3 ensures that if $z(\id)$ is degenerate, then so is all of $z$.

There is a morphism $h\of Z\to Y$ which satisfies $h(z) = (f,l_Y)(z(\id_{[\dim(z)]}))$. This morphism is contractible thanks to the following filler construction. Let $a\of \cycle[n]\to Z$ and $b\of \simplex[n]\to Y$ satisfy $h\circ a = b\circ k$ where $k\of\cycle[n]\to\simplex[n]$ is the cycle inclusion. Let $c\of \simplex[n]\to Z$ satisfy $c(\phi)(\mu) = \tuplet{\phi,b(\mu)}$ if $\phi$ is an epimorphism and $c(\phi)(\mu) = a(\phi)(\mu)$ otherwise. Now $c\circ k = a$ and $h\circ c = b$ so $c$ is a filler. There is a morphism in $\ambient\s$ that maps each commutative square $h\circ a = b\circ k$ to this filler $c$ because $\ambient\s$ is locally Cartesian closed and being an epimorphism is a decidable property of morphisms of $\simCat$.
\end{proof}\hide{ Codomains of contractibles may have a distance function, that gives a lower bound to the number of compositions required to to reach it. I don't have time to work that out and check it right now.}

\begin{lemma} Contractible morphisms are acyclic cofibrations.\label{Reedy}\end{lemma}

\begin{proof} The class of morphisms that have the left lifting property with respect to contractible morphism is saturated (see lemma \ref{saturation}). This proof show why all cofibrations are in this class, which means that all contractible morphisms have the right lifting property with respect to all cofibrations.

Suppose $f\of X\to Y$ is a cofibration and $S$ is the family of faces outside the image of $f$. For each $i\of\nno$ let $Y_i$ be the union of $X$ with all faces of $Y$ of dimension strictly smaller than $i$. In particular $Y_0=X$.

Every simplex of $Y$ is in $Y_i$ for some $i$. If a simplex $y\of\base Y$ is degenerate, then one can search the monomorphisms $[n]\to\dim y$ in $\simCat$ for the greatest $\mu$ such that $y\cdot\mu$ is a face. For this reason, the inclusion $Y_i\to\nno\ri Y$ is a transfinite composition (see definition \ref{transfinite composition}).

For each $i\of\nno$ let $S_i$ be the object of $n$-dimensional faces in $S$. Each $s\of S_i$ induces a monomorphism $s'\of\simplex[i]\to Y_{i+1}$. Since $Y_{i}$ has all simplices of dimension $i-1$, the intersection of $Y_i$ and $s'$ is $\cycle[i]$. Thus the inclusion $Y_i\to Y_{i+1}$ is the push out of $S_{i+1}$ copies of $\cycle[i]\to\simplex[i]$.

Cofibrations have the left lifting property by lemma \ref{saturation} below.
\end{proof}

\begin{definition} Let $\cat A$ be a $\Pi$-pretopos with a natural number object $\nno$. The successor morphism $s\of\nno\to\nno$ induces an endofunctor $s\ri$ of $\ambient/\nno$. A \keyword{cochain} is a morphism $f\of X\to s\ri(X)$ in $\cat A/\nno$. A morphism of cochains $(X,f)\to(Y,g)$ is a morphism $h\of X\to Y$ such that $s\ri(h)\circ f = g\circ h$.

For every object $Y$ of $\ambient$ there is a constant family $\nno\ri(Y)$ and an isomorphism $\nno\ri(Y)\simeq s\ri(\nno\ri(Y))$. The \keyword{transfinite composition} of a cochain $(X,g)$ is a cochain morphism $\traco(g)\of (X,f)\to\nno\ri Y$ such that for every other morphism $k\of (X,f)\to\nno\ri Z$ there is a unique morphism $l\of Z\to Y$ such that $s\ri(l)\circ \traco(g)=k$.
\end{definition}

\begin{lemma} The class of morphisms $L$ that has the left lifting property with respect to fibrations is closed under pushouts, coproducts indexed over objects of $\ambient$ and transfinite compositions. \label{saturation}\end{lemma}

\begin{proof}
In each case the construction induces an operation on the split epimorphism in the diagram of the lifting property. These operations happen to preserve split epimorphisms.

Suppose $h\of I'\to J'$ is a pushout of $g\of I\to J$ where $g$ has the left lifting property with respect to $f\of X\to Y$. Because the functors $\nat(-,X)$ and $\nat(-,Y)\of(\ambient\s)\dual\to\ambient$ send pushouts to pullbacks, $\tuplet{f_!,h\ri}$ is a pullback of $\tuplet{f_!,g\ri}$ and the former is a split epimorphism because the latter is.
\hide{ It is probably a good idea to add a diagram here, but let's postpone actually drawing one.
\[\xy
(34,40)*+{\nat(I,X)}="top",(0,20)*+{\nat(J,X)}="left",(24,20)*+{\bullet}="middle",(44,20)*+{\nat(I,Y)}="right",(34,0)*+{\nat(J,Y)}="bottom"
,%
(34,50)*+{\nat(I',X)}="top2",(0,30)*+{\nat(J',X)}="left2",(24,30)*+{\bullet}="middle2",(44,30)*+{\nat(I',Y)}="right2",(34,10)*+{\nat(J',Y)}="bottom2"
%
\ar^{\nat(g,\id_X)} "left";"top" \ar@{.>}|(.6){\tuplet{f_!,g\ri}} "left";"middle" \ar_{\nat(\id_J,f)} "left";"bottom" \ar "middle";"bottom"
\ar "middle";"top" \ar^(.6){\nat(\id_I,f)} "top";"right" \ar_(.6){\nat(g,\id_Y)} "bottom";"right"
%
\ar^{\nat(h,\id_X)} "left2";"top2" \ar@{.>}|(.6){\tuplet{f_!,h\ri}} "left2";"middle2" \ar_{\nat(\id_{J'},f)} "left2";"bottom2" \ar "middle2";"bottom2"
\ar "middle2";"top2" \ar^(.6){\nat(\id_{I'},f)} "top2";"right2" \ar_(.6){\nat(h,\id_Y)} "bottom2";"right2"
\endxy\]}

Suppose $h\of(\Pi i\of I.\nat(X(i),Y(i)))$ represents a family of morphisms of that share the left property. That means $\tuplet{(I\disc\ri(f))_!,h\ri}$ is a split epimorphism and therefore so is its transpose $\tuplet{f_!,\Sigma_I(h)\ri}$, where $\Sigma_I(h)$ is the indexed coproduct of the family $h$.

Finally, suppose that a cochain $(Z,h)$ has the left lifting property. That means $\tuplet{\nno\disc\ri(f)_!,h\ri}$ is a split epimorphism. For the transfinite composition $\traco(h)$, $\tuplet{f_!,\traco(h)\ri}$ if also split.
\end{proof}
\end{document}