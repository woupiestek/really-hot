\documentclass[csh.tex]{subfiles}
\begin{document}

\section{Descent}
A univalent universe that could serve as a model for homotopy type theory, has to live inside the category of complexes $\ambient\s\f$ itself because the model structure is limited to that part. This section shows that fibrancy is automatic for universal fibrations of certain classes of morphisms.

\newcommand\dprod[1]{\Pi_{#1}}
Assume that there is a class $M$ of \emph{modest morphisms} in $\ambient\s$ with the following properties.
\begin{itemize}
\item $M$ is closed under pullbacks along arbitrary morphisms.
\item $M$ is closed under composition.
\item $M$ is closed under dependent products. This means that if $f:X\to Y$ belongs to $M$ and $g:Y\to Z$ is an arbitrary morphism, then the product of $f$ along $g$--$\dprod g(f) \of \dprod g(X)\to Z$--is in $M$ too. This requirement may give us more limits than we need, but the intended model of modest morphisms in the ex/lex completion of the category of assemblies satisfies it.
\item $M$ contains all \emph{regular} monomorphisms--a monomorphism is \emph{regular} if it is an equalizer. Since $\ambient$ may lack a subobject classifier, there can be irregular monomorphisms which $M$ can afford to miss.
\item If $f\circ g\of M$ and $g$ is a regular epimorphism, then $f\of M$. %isn't true of modest sets is it?
\end{itemize} 

The interesting case is where $M$ has the following structure in addition to the properties above.

\begin{definition} A \keyword{universal modest fibration} is a modest fibration $\uni\of U\to V$ such that every modest fibration $f\of X\to Y$ is the pullback of $\uni$ along a unique morphism $\chi(f)\of Y\to V$.
\end{definition}

The following fact makes the universal modest fibration a potential model of homotopy type theory.

\begin{theorem} If $\uni\of U\to V$ is a universal modest fibration, then $V$ is fibrant. \label{fibrant universe} \end{theorem}

Let's start with some notation that will be useful throughout the rest of this section.
%%%formally introduce the object of problems
\newcommand\LP{\mathbf{LP}}
\newcommand\foh{\mathbf{h}}
\begin{definition}
There is an \keyword{object of lifting problems} $\LP$ in $\ambient$consisting of tuples $p = \tuplet{\top(p),\dim(p),\horn(p)\of\horn_{\top(p)}[\dim(p)]\to V}$. 
There is an $\LP$-indexed coproduct of acyclic cofibrations $\foh_\LP\of\horn_\LP \to \simplex_\LP$ in $\ambient\s$: the pullback of the family of horn inclusions $\foh_{\set\leq}\of\horn_{\set\leq} \to \simplex_{\set\leq}$ along $(\function{p\of P}\tuplet{\top(p),\dim(p)})\disc$.
\[\xymatrix{
\horn_\LP \ar[r]^{\foh_\LP}\ar[d] & \simplex_\LP\ar[d]\ar[r] & \LP\disc\ar[d]^{(\top\times\dim)\disc} \\
\horn_{\set\leq} \ar[r]_{\foh_\LP} & \simplex_{\set\leq}\ar[r] &\set\leq\disc
}\]
There is a canonical morphism $\horn(\LP)\of \horn_\LP\to V$:
\[ v\tuplet{\tuplet{\top(p),\dim(p),\xi\of \dom(\horn(p))},p} = \horn(p)(\xi)\]
\end{definition}

\begin{remark} The object $V$ is fibrant if and only if the canonical morphism $\horn(\LP)$ factors through $\foh_\LP$. On on hand such a factorization solves all the lifting problems. On the other, $\foh_\LP$ is a discrete family of acyclic cofibrations.
\end{remark}

\begin{proof}[of \ref{fibrant universe}]
The modest fibration $\horn(\LP)\ri(\uni)\of \horn_P\times_V U \to \horn_P$ descents along $\foh_\LP$ to form a modest fibration $D(v\ri(\uni))\of \bullet\to\simplex_\LP$ by lemma \ref{descent}. 
Descent means that $\horn(\LP)\ri(\uni)$ is the pullback of $D(\horn(\LP)\ri(\uni))$ along $\foh_\LP$.
By the existence part of definition \ref{universal modest fibration} there is a $\chi\of\simplex_\LP\to V$ such that $D(\horn(\LP)\ri(\uni))$ is the pullback of $\uni$ along $\chi$ making $\horn(\LP)$ a pullback of $\uni$ along $\chi\circ \foh_\LP$. By the uniqueness part of definition \ref{universal modest fibration} $\chi\circ \foh_\LP=\horn(\LP)$, which proves that $V$ is fibrant.
\[\xymatrix{
\horn_\LP\times_V U \ar@/^2ex/[rrr] \ar[r]\ar[d]_{v\ri(\uni)} & \bullet \ar[rr]\ar[d]|{D(v\ri(\uni))} && U\ar[d]^\uni\\
\horn_\LP\ar@/_2ex/[rrr]_{\horn(\LP)}\ar[r]^{\foh_\LP} & \simplex_\LP\ar[rr]^{\chi} && V
}\]
\end{proof}

\begin{lemma}
There is an adjoint pair of functors $A\dashv D\of \ambient\s/\horn_\LP \to \ambient\s/\simplex_\LP$ such that
\begin{enumerate}
\item $A$ preserves acyclic cofibrations and hence $D$ preserves fibrations.
\item $A\circ\foh_! = \id_{\ambient\s/\horn_\LP}$, hence $\foh^* \circ D = \id_{\ambient\s/\horn_\LP}$ too.
\item $D$ preserves modest morphisms.
\end{enumerate}
\label{descent}
\end{lemma}

\newcommand\dsum[1]{\Sigma_{#1}}
\begin{proof}



\hide{
- distributions and their $M$ preserving adjoint functors.
- the special distribution, and the two resulting properties of ascent.
}

Reindexing along $\foh_\LP$ has a right adjoint $(\foh_\LP)_*$, which nearly satisfies the requirements. As required for descent, $\foh_\LP\ri((\foh_\LP)_*(f))$ is isomorphic to $f$ because $\foh_\LP$ is a monomorphism. For $f\of X\to \horn_\LP$, the product is modest whenever $f$ is modest. Moreover, $(\foh_\LP)_*(f)$ has the right lifting property with respect to acyclic cofibrations that the reindexing functor $\foh_\LP\ri$ sends to acyclic cofibrations. However, since $\foh_\LP\ri$ doesn't always preserve acyclic cofibrancy, the product is not a fibration.

The construction of $Df$ informally works as follows.
$\ambient\s/\simplex_\LP$ is equivalent to $\ambient^{\cat P\dual}$ for an internal category $\cat P$ of $\ambient$, and $\ambient\s/\horn_\LP$ is equivalent to $\ambient^{\cat Q\dual}$ for a subcategory $\cat Q$ of $\cat P$. There is a functor $S\of\cat P\to \ambient^{\cat P\dual}$ such that: %def
\begin{itemize}
\item for each object $Q$ of $\cat Q$, $S(Q)$ factors through $\foh_\LP$.
\item for each acyclic cofibration $m$ of $\cat P$, $\foh_\LP\ri(S(m))$ is an acyclic cofibration.
\end{itemize}
The underlying object of $D(X)$ consists of maps $S(\xi)\to(\foh_\LP)_*(f)$--or equivalently maps $\foh_\LP\ri(S(\xi))\to f$. %def
The conditions imply both that $D(f)$ is a fibration and that $\foh_\LP\ri(Df) \simeq f$. %lemma
Moreover, because the underlying map of $Df$ is still a dependent product of a member of $M$, the underlying map of $Df$ belongs to $M$ as well. %lemma
\[\xymatrix{
\horn_\LP\times_{\simplex_\LP}\bullet\ar[r]^(.7){S(\xi)\ri(\foh_\LP)}\ar[d]_{\foh_\LP\ri(S(\xi))} & \bullet\ar[d]^{S(\xi)}\\
\horn_\LP \ar[r]_{\foh_\LP} & \simplex_\LP
}\]
Details are worked out in definition and lemmas below which deal with internalization of this construction in $\ambient$.
\end{proof}

As far as candidates for descend go, functors with a left adjoints gives more ways to prove the desired properties.
\begin{lemma}
Let $m\of A\to B$ in $\ambient\s$ be any morphism of simplicial objects.
Let $D\of \ambient\s/A \to \ambient\s/B$ have a left adjoint $S$.
\begin{enumerate}
\item The functor $D$ is left inverse to $m\ri$ if for each $a\of\simplex[i]\to\simplex[j]\to A$, if $S$ is right inverse to $m_!$.
\item The functor $D$ preserves fibrations if $S$ preserves acyclic cofibrations. 
\end{enumerate}
\end{lemma}

\begin{proof}
Both follow directly from the definition of adjoint functors.
\end{proof}

Morphisms between simplicial object induce adjoint pairs of functors between slice categories, but we cannot rely on those. 
Distributions are generalized functions. The distributions down here are supposed to do that for morphisms of simplicial objects.

\mathrmdef{supp}
\mathrmdef{cosupp}
\mathrmdef{codim}
\newcommand\ecof[1]{\llbracket #1 \rrbracket}
\begin{definition} For each pair of simplicial object $X$,$Y$, a \keyword{distribution} $\Phi\of X\nrightarrow Y$ is a tuple 
$\tuplet{|\Phi|,\supp,\cosupp,\cdot}$ where 
\begin{itemize}
\item $|\Phi|$ is an object and $\supp \of |\Phi| \to X$ is a morphism of $\ambient\s$.
\item $\cosupp\of\base|\Phi|\to\base(Y)$.
\item For all $\phi\of\Ar(\simCat)$, $y\of\base Y$ and $x\of\base|\Phi|$ 
if $\cosupp(x) = y\cdot \phi$, then $\phi\cdot x$ is defined, $\cosupp(\phi\cdot x) = y$ and $\dim(\phi\cdot x) = \dim(x)$.
\end{itemize}

The \emph{inverse image} functor $\Phi\ri\of\ambient\s/Y\to\ambient\s/X$ of a distribution $\Phi$ is defined as follows. 
For each $a\of A\to Y$,
\begin{align*}
\base(\Phi\ri(A)) &= \set{\tuplet{x\of\base|\Phi|,y\of\base(A)} | \cosupp(x) = a(y) }/\mathord\sim\\
\Phi\ri(a)\ecof{\tuplet{x,y}} &= \supp(x)\\
\ecof{\tuplet{x,y}}\cdot\phi &= \ecof{\tuplet{x\cdot\phi,y}} \\
\end{align*}
Here $\sim$ is the least equivalence relation such that $\tuplet{\phi\cdot x,y}\sim\tuplet{x,y\cdot\phi}$ for all suitable $\phi$, $x$ and $y$; $\ecof{\cdot}$ is the coequalizer for $\sim$. The definition of distributor guarantees that the dimensions and action are well defined on the elements of $\Phi\ri(A)$.
For each morphism $f\of A\to B \to Y$ of $X\ri\of\ambient\s/Y$, $\Phi\ri(f)\ecof{\tuplet{x,y}} = \ecof{\tuplet{x,f(y)}}$.

The \emph{direct image} functor $\Phi_*\of\ambient\s/X\to\ambient\s/Y$ of a distributor $\Phi$ is defined as follows. For each $b:B\to X$,
\begin{align*}
\base(\Phi_*(B)) &= \set{ \tuplet{y\of\base(Y),f\of F(y)}  \middle| 
\begin{array}{l}
F(y) = \set{x\of \base|\Phi||\cosupp(x) = y}\to \base(B)\\
\dim_B\circ f = \dim_\Phi\\
(\function{\tuplet{x,\phi}}{f(x\cdot\phi)}) = (\function{\tuplet{x,\phi}}{f(x)\cdot\phi}) 
\end{array}
}\\
\Phi_*(b)\tuplet{y,f} &= y\\
\tuplet{y,f}\cdot \phi &= \tuplet{y\cdot \phi,\function x f(\phi\cdot x)}
\end{align*}
For each morphism $g\of B\to A\to Y$, $\Phi_*(g)\tuplet{y,f} = \tuplet{y,g\circ f}$
\end{definition}

\begin{lemma}
The inverse image functor $\Phi\ri$ is left adjoint to the direct image functor $\Phi_*$ for any distribution $\Phi$. Both send members of $M$ to $M$.
\end{lemma}

\begin{proof} This follows from the definition, though that may be hard to see.
\end{proof}

The descend functor is the direct image functor belonging to the distribution defined next.

\newcommand\dset{\mathord\downarrow}
\mathbfdef{nds}
\begin{definition}
Define the underlying object and dimension of the simplicial object $S$ as follows.
\begin{align*}
\base(S) &= \set{\tuplet{\xi\of\Ar(\simCat),k\of\cod(\xi),f\of\nds(\dom
\xi),g\of \nds(\product{l\neq k} \xi_l)}|
\#(f)+\#(g)>0 }\\
\textrm{where }\xi_l &= \set{i\of\dom(\xi)|\xi(i) = l}\\
\dim\tuplet{\xi,k,f,g} &= \#(f) + \#(g) - 1
\end{align*}
Here $\nds$ maps partially ordered objects to the objects of non decreasing sequence, which is similar to the nerve, except that empty sequences are allowed too. The operator $\#$ is the number of elements in the sequence.

The action $\cdot$ is a bit convoluted. Its splits a morphism $\phi\of[n]\to[\#(f)+\#(g)+1]$ into two parallel parts which it composes with $f$ and $g$. The part of $\phi$ that applies to $g$ is the part that maps to the interval $[a\tuplet{\xi,k,f,g}, b\tuplet{\xi,k,f,g}]$, where:
\begin{align*}
a\tuplet{\xi,k,f,g} &= \min(\set{ i\of[\#(f)+\#(g)+1] | i\geq\#(f) \vee \xi(f(i)) > k })\\
b\tuplet{\xi,k,f,g} &= \max(\set{ i\of[\#(f)+\#(g)+1] | \phi(i)\leq\#(g) \vee \xi(f(i - \#(g))) \leq k })
\end{align*}
Two parts of $\phi$ can therefore apply to $f$, namely the restrictions to $\set{i\of\dom(\phi)|i<a(\phi)}$ and $\set{i\of\dom(\phi)|i>b(\phi)}$
where: 
\begin{align*}
a(\phi) &= \min(\set{ i\of\dom(\phi) | \phi(i)\geq a\tuplet{\xi,k,f,g} }\cup\set{\dim(\phi)+1})\\
b(\phi) &= \max(\set{ i\of\dom(\phi) | \phi(i)\leq b\tuplet{\xi,k,f,g} }\cup\set{-1})
\end{align*}
The action works as follows.
\begin{align*}
\tuplet{\xi,k,f,g}\cdot\phi &= \tuplet{\xi,k,f\phi,g\phi}\\
\textrm{where }f\phi(i) &= f(\phi(i))&\textrm{ if }& i < a(\phi)\\
\textrm{and }f\phi(i) &= f(\phi(i + b(\phi) - a(\phi) + 1) - \#(g))&\textrm{ if }& i \geq a(\phi)\\
\textrm{and }g\phi(i) &= g(\phi(i + a(\phi)) - \phi(a(\phi)))
\end{align*}

Define the morphism $\supp \of S\to \simplex_{\leq}$ as follows.
\begin{align*}
s\tuplet{\xi,k,f,g}(i) &= f(i)&&\textrm{ if } i < a\tuplet{\xi,k,f,g}\\
s\tuplet{\xi,k,f,g}(i) &= f(i-\#(g))&&\textrm{ if } i > b\tuplet{\xi,k,f,g}\\
s\tuplet{\xi,k,f,g}(i) &= k&&\textrm{ otherwise }
\end{align*}

The remaining structure can be define as follows.
\begin{align*}
\cosupp\of\base(S)&\to\simplex_{\set\geq}\\
\cosupp\tuplet{\xi,k,f,g} &= \xi\\
\phi\cdot\tuplet{\xi\circ \phi,k,f,g} &= \tuplet{\xi,k,\phi\circ f, \phi\circ g}
\end{align*}
\end{definition}





\section{Junk}
\begin{definition}
Define partially ordered object $(S,\leq)$ in $\ambient$ as follows.
\begin{align*} 
S =& \set{\tuplet{p,\sigma,0,j}|\tuplet{p,\sigma}\of\base(\simplex_\LP),j\of[\dom(\sigma)]}\cup\\&
\set{\tuplet{p,\sigma,1,j}|\tuplet{p,\sigma}\of\base(\simplex_\LP),
j\of[\dim(p)-1]\to [\dom(\sigma)],\sigma\circ j = d_{\top(p)}}\\
\end{align*}
Here $d_i$ is the \keyword{face map} $[\dim(p)-1]\to[\dim(p)]$ that satisfies $d_i(j) = j$ if $j<i$ and $d_i(j) = j+1$ if $j\geq i$.
\begin{align*}
\tuplet{p,\sigma,0,j}\leq\tuplet{p',\sigma',0,j'} &
\iff p=p',\sigma=\sigma',j\leq j'\\
\tuplet{p,\sigma,0,j}\leq\tuplet{p',\sigma',1,j'} &
\iff p=p',\sigma=\sigma',j \leq i'\\ 
\tuplet{p,\sigma,1,j}\leq\tuplet{p',\sigma',0,j'} &
\iff p=p',\sigma=\sigma',i < j'\\ 
\tuplet{p,\sigma,1,j}\leq\tuplet{p',\sigma',1,j'} &
\iff p=p',\sigma=\sigma',\forall k\of[\dim(p)-1].j(k)\leq j'(k)
\end{align*}

Partially ordered objects like $(S,\leq)$ have a \keyword{nerve} $N(S,\leq)$ which is a simplicial object. The object $\base(N(S,\leq))$ consist of \emph{non decreasing} maps $[n]\to S$ for arbitrary $n\of\nno$. For $y\of \base(N(S,\leq))$:
\begin{align*}
[\dim(y)] &= \dom(y)&
y\cdot \phi &= y\circ \phi
\end{align*}
Note that because $[n]$ is connected, nondecreasing $y\of[n]\to S$ are constant in the first two variables, uniquely defining the functions $s\of \base(N(S,\leq))\to \simplex_\LP$ and $p\of \base(N(S,\leq))\to \LP$
where $s(y)$ is the first two elements of $y(0)$ and $p(y)$ is the first element of $y(0)$. Let $t\of N(S,\leq)\to \simplex_\LP$ satisfy 
$t(y) = \tuplet{p(y),\tau\circ y}$ where $\tau\tuplet{p,\sigma,0,j} = \sigma(j)$ and $\tau\tuplet{p,\sigma,1,j} = \top(p)$.

%here
\end{definition}




\subsection{Cosimplicial objects}
This subsection delves into cosimplicial objects in $\ambient$ to show how adjoint pairs of functors between slice categories of $\ambient\s$ can be constructed from them. The goal is to demonstrate constructiveness rather than to present something new. We are essentially deriving adjoint pairs of functors between presheaf toposes from functors between their categories of representables.

\mathrmdef{codim}
\begin{definition} A cosimplicial object $C$ of $\ambient$ is a tuple $\tuplet{\base(C),\codim,\cdot}$ where $\base(C)$ is an object of $\ambient$, $\dim\of\base(C)\to\nno$ is an arbitrary morphism and $\cdot\of \dom\times_{\nno}\codim \to \base (C)$ for $\dom\of \Ar(\simCat)\to\nno$
 satisfies $\codim(\gamma\cdot c) = \cod(\gamma)$.
\end{definition}

Cosimplicial are like simplicial objects, but with the dual action of the category $\simCat$.

\begin{definition} Let $A$ and $B$ be simplicial sets and let $C$ be a cosimplicial object of $\ambient\s/\cat B$ such that the underlying morphism of $\codim(C)$ factors through $\dim(A)$ in $\ambient$. This means that $C$ has both a simplicial and a cosimplicial structure, and that
there are $a\of\base(C)\to\base(A)$ and $b\of\base(C)\to\base(B)$ such that 
\begin{align*}
\dim(c) &= \dim(b(c)) & \codim(c) &= \dim(a(c))\\b(\phi\cdot c) &= b(c) & b(c\cdot\phi)&=b(c)\cdot\phi\\
\end{align*}

Define the functor $C\ri\of\ambient\s/A\to \ambient\s/B$ as follows. For each object $f\of X\to A$ in $\ambient \s/A$ let $\base(C\ri(X))$ be the quotient of $\set{\tuplet{x,c}\of \base(X)\times \base(C)| f(x)=a(c) }$ by the least equivalence relation $\sim$ such that $\tuplet{x\cdot\phi,c}\sim\tuplet{x,\phi\cdot c}$. Let $M\ri(f)(\tuplet{x,c}) = b(c)$--this is well defined on the quotient. 
The simplicial structure of $\base(C\ri(X))$ is defined by the equations $\dim(\tuplet{x,c}) = \dim(c)$ and $\tuplet{x,c}\cdot \phi = \tuplet{x,c\cdot\phi}$ because equivalent pairs are mapped to the same value as well. They also turn $M\ri(f)$ into a morphism of simplices as required. For each object $g\of Y\to A$ in $\ambient \s/A$ and each morphism $h\of f\to g$ let $C\ri(h)\tuplet{x,a} = \tuplet{h(x),a}$--once again this is well defined on the quotients. Because $C\ri$ preserves composition and identities, is indeed a functor.

Define the functor $C_*\of\ambient\s/B\to \ambient\s/A$ as follows. For each object $f\of X\to B$ let 
\[ \base(C_*(X)) = \set{g\of \dprod a(b\ri(X)) | \forall \tuplet{c,\phi}\of\codim(C)\times_\nno\dom(\Ar(\simCat)).g(\phi\cdot c)= g(c)\cdot \phi }\]
Pointwise application gives $\base(C_*(X))$ the structure of a simplicial object over $a$. It is also how $C_*$ is defined for morphisms in a way that preserves composition and identities, making $C_*$ a functor.

The functor $C_*$ is right adjoint to the functor $C\ri$. 
A morphism $f\of X\to C_*Y$ is a morphism $f\to X \to \dprod a(b\ri(Y))$ that satisfies $f(x\cdot\phi)(c) = f(x)(c)\cdot\phi = f(x)(\phi\cdot c)$. Therefore the transpose $f^t\of \dsum b(a\ri(X)) \to Y$, which satisfies $f^t\tuplet{x,c} = f(x)(c)$, factors uniquely through $C\ri(X)$. In the other direction, a morphism $g\of C\ri\to Y$ can be composed with the quotient map $\dsum b(a\ri(X)) \to C\ri(X)$ and transposed to get a morphism $g\of X \to \dprod a(b\ri(Y))$ that factors through the inclusion $C_*Y\to \dprod a(b\ri(Y))$. \hide{Where do $\dprod a$ and $\dsum b$ live?}
\end{definition}

\begin{remark} 
\hide{What is this all about? Add reference to $M$.}
The class $M$ is closed under $C_*$ and $C^*$ since the class $M$ is assumed to be closed under all the necessary constructs. \end{remark}


The rest of this section works out the definition and the properties of $K$.

\begin{definition}
Define the internal category $\cat P$ of $\ambient$ as follows. The objects of $\cat P$ are pairs $\tuplet{\sigma,k}$ where $\sigma\of\Ar(\simCat)$ and $k\of \cod(\sigma)$. A morphism $\tuplet{\sigma,k}\to \tuplet{\sigma',k}$ is a morphism $\phi\of \dom(\sigma)\to \dom(\sigma')$ such that $\phi\circ \sigma'= \sigma$. There are only morphisms between pairs $\tuplet{\sigma,k}$ and $\tuplet{\sigma',k'}$ where $k=k'$ so $\cat P$ is a indexed coproduct of copies of categories of the family $\function{n\of\nno}\simCat/[n]$.

Define the functor $K\of \cat P\to\cat P$ as follows:
\begin{enumerate}
\item A monotone function $\sigma\of[m]\to[n]$ cuts $[m]$ into $n + 1$ posets $\sigma_j = \set{i\of[m]|\sigma(i)=j}$. 
 Let $\norm{\sigma,k}$ be the number of elements of the product $\product{i\of ([n]-\set k)}{\sigma_i}$. 
\item Define $K_0\tuplet{\sigma,k}\of [m+\norm{\sigma,k}]\to [n]$ as follows.
\[ 
	K_0\tuplet{\sigma,k}(i) = \left\{
		\begin{array}{cc}
			\sigma(i) & \sigma(i)<k \\
			k & \sigma(i-\norm{\sigma,k})\leq k \leq \sigma(i)\\
			\xi(i-\norm{\xi,k}) & k<\xi(i-\norm{\xi,k})
		\end{array}
	\right.
\]

\item In the \keyword{lexicographical product} $\product{i\of([n]-\set k)}{\xi_i}$ tuples get the \keyword{lexicographical ordering}. This ordering determines priority by comparing elements in sequence.
\begin{align*} 
(x_0,x_1,\dotsc) \leq_{\rm lex} (y_0,y_1,\dotsc) \iff& x_0\leq y_0 \land (x_0=y_0 \to (x_1,\dotsc)\leq_{\rm lex}(y_1,\dotsc))
\end{align*}

\item Let $\ka\tuplet{\xi,k}\of\product{i\of([n]-\set k)}{\xi_i} \to [m+\norm{\xi,k}]$ be the \emph{nondecreasing} injection $\ka$ which sends the lexicographical product $\product{i\of([n]-\set k)}{\xi_i}$ to the interval in $[m+\norm{\xi,k}]$ which starts at the least $i$ such that $K_0\tuplet{\xi,k}(i)=k$.

\item Let $\la\tuplet{\xi,k}\of[m]\to[m+\norm{\xi,k}]$ be the unique nondecreasing injection which skips the image of $\ka$. This means $\la(i)=i$ if $\xi(i)<k$ and $\la(i)=i+\norm{\xi,k}$ if $\xi(i)\geq k$. Moreover $K_0\tuplet{\xi,k}\circ\la\tuplet{\xi,k} = \xi$.

\item For each morphism $\phi\of\tuplet{\xi,k}\to\tuplet{\xi',k}$ in $\simCat/[n]$ let $\phi_i\of\xi_i\to\xi'_i$ be the fibrewise morphism and let $\product{i\of([n]-\set k)}{\phi_i}$ be the corresponding map of the (lexicographical) products $\product{i\of([n]-\set k)}{\xi_i}\to\product{i\of([n]-\set k)}{\xi'_i}$. Let $K_1(\phi)\of K_0\tuplet{\xi,k}\to K_0\tuplet{\xi',k}$ be the unique nondecreasing function which satisfies $K_1(\phi)\circ \ka\tuplet{\xi,k} = \ka\tuplet{\xi',k}\circ \product{i\of([n]-\set k)}{\phi_i}$ and $K_1(\phi)\circ \la\tuplet{\xi,k} = \la\tuplet{\xi',k}\circ \phi$.
\end{enumerate}

The maps $(K_0,K_1)$ define an endofunctor of $\simCat/[n]$. To get the functor, let $K(\xi) = h\ri(\simplex(K_0(\xi)))$ for objects $\xi$ of $\simCat/[n]$ and $K(\phi) = h\ri(\simplex(K_1(\phi)))$ for morphisms, where $h\ri$ is the reindexing functor $\ambient\s/\simplex[n]\to\ambient\s/\horn_k[n]$ along the horn inclusion $h\of \horn_k[n]\to\simplex[n]$. Concretely, $K$ satisfies the following equations for all objects $\xi$ of $\simCat/[n]$, all $x\of \base(\dom(K(\xi)))$ and all arrows $\phi$ of $\simCat/[n]$.
\begin{align*}
\base(\dom(K(\xi))) &= \set{ x\of\base\simplex[m+\norm\xi]| K_0(\xi)\circ x\of\base\horn_k[n]}\\
K(\xi)(x) &= K_0(\xi)\circ x \\
\dim(x) &= \dom(x) \\
x\cdot\phi &= x\circ\phi \\
K(\phi)(x) &= K_1(\phi)\circ x
\end{align*}
\end{definition}

Thanks to the following property, the natural equivalence of homsets above extends to horn inclusions.

\begin{lemma} In $\cat P$ an \keyword{intersection} is a pullback square of monomorphisms. The functor $K$ preserves all intersections. \end{lemma}

%here

\begin{proof} The easiest way to see that is to describe the monomorphisms in the intersection as decidable predicates on the domain of a map $\xi\of[m]\to[n]$. Maps $[m]\to\bool$ that equals $\true$ at least once characterize monomorphisms to $\xi$. The action of the endofunctor $(K_0,K_1)$ on the monomorphism has a parallel on predicates. For each $p\of[m]\to\bool$ the following equations define $p^K\of [m+\norm\xi]\to\bool$. 
\begin{align*}
p^K(\kappa(\vec x)) &= \forall i\of[m]-\set k.p(x_i) &
p^K(\lambda(x)) &= p(x)
\end{align*}
It all works out because $\forall i\of[m]-\set k.p(x_i)\land q(x_i)$ is equivalent to $(\forall i\of[m]-\set k.p(x_i))\land(\forall i\of[m]-\set k.q(x_i))$.
\end{proof}

\begin{definition}
For each $f\of X\to\horn_k[n]$ the functor $D\of \ambient\s/\horn_k[n]\to\ambient\s/\simplex[n]$ satisfies the following equations.
\begin{align*}
\base(\dom(D(f))) &= \sum_{\xi\of\base\simplex[n]}(\ambient\s/\horn_k[n])(K(\xi),f)\\
\dim\tuplet{\xi,x} &= \dom(\xi)\\
\tuplet{\xi,x}\cdot\phi &= \tuplet{\xi\circ\phi,x\circ K(\phi)}\\
D(f)\tuplet{\xi,x} &= \xi
\end{align*}
On morphisms in $\ambient\s/\horn_k[n]$, the functor $D$ acts by composition: $Dm(\xi,x) = (\xi,m\circ x)$. \label{descent functor}
\end{definition}

If $\ambient$ has infinite colimits, the functor $D$ has a left adjoint $K'$ that satisfies $K'\simplex\simeq K$. We cannot rely on that property here. The functor $K$ does extend to finite colimits of simplices. Preservation of intersections implies that $K$ also applies to finite unions of simplices like $\horn_l[m]$. The reason $D$ preserves fibrations and their right lifting property, is that its partial left adjoint preserves the left lifting property. 

\begin{definition} We introduce a notation for monomorphisms in $\simCat/[n]$ or more accurately for the result of applying the functor $\simplex\of \simCat/[n] \to \ambient\s/\simplex[n]$ to them. For $\xi\of[m]\to[n]$ and $\phi\of[m]\to\bool$ let $\face(\xi,p)\of \dom(\face(\xi,p))\to \simplex[m]$ satisfy
\begin{align*}
\base(\dom(\face(\xi,p))) &= \set{\alpha\of\base(\simplex[m])\middle|\forall i\of \dom(\alpha).p\circ\alpha(i)=\true}\\
\dim(\alpha) &= \dom(\alpha)\\
\alpha\cdot\chi &= \alpha\cdot\chi\\
\face(\xi,p)(\alpha) &= \alpha
\end{align*}
\[\xymatrix{
\bullet\ar[rr]^{\face(\xi,p)}\ar[dr] && \simplex[m]\ar[dl]^{\simplex(\xi)} \\
& \simplex[n]
}\]
\end{definition}

With the help of this notation, important commutative triangles of monomorphisms can be written as follows.
\begin{align}
&\horn_l[m]\stackrel{\hat h}\to \simplex[m]\stackrel{\simplex(\xi)}\to \simplex[n] = \bigvee_{i\of [m]-\set l} \face(\xi,\function x{x\neq i})\\
&K(\horn_l[m])\stackrel{K(\hat h)}\to \simplex[m+\norm\xi]\stackrel{\simplex(K_0(\xi))}\to \simplex[n] = \bigvee_{j\of [m]-\set l} \face(K_0(\xi),v_j)\\
&h\ri(K(\horn_l[m]))\stackrel{h\ri(K(\hat h))}\to h\ri(\simplex[m+\norm\xi])\stackrel{h\ri(\simplex(K_0(\xi)))}\to \horn_l[n] = \\
&\quad\left(\bigvee_{i\of[n]-\set k} \face(K_0(\xi),u_i)\right)\wedge\left(\bigvee_{j\of [m]-\set l} \face(K_0(\xi),v_j)\right)=\\
&\quad\left(\bigvee_{\substack{i\of[n]-\set k\\j\of [m]-\set l}}\face(K_0(\xi),u_i\land v_j)\right)\\
&h\ri(\simplex[m+\norm\xi])\stackrel{h}\to \simplex[m+\norm\xi]\stackrel{K_0(\xi)}\to \simplex[n] =\left(\bigvee_{i\of[n]-\set k} \face(K_0(\xi),u_i)\right)
\end{align}
\begin{center}
where
\end{center}
\begin{align*}
u_i(x) &= (K_0\xi(x)\neq i) & 
v_i(\kappa(\xi)(\vec x)) &= (\xi(i)= k\vee x_{\xi(i)}\neq i)\\
v_i(\lambda(\xi)(x)) &= (x\neq i)&
u_i\land v_i(x) &= u_i(x)\land v_i(x)
\end{align*}


\begin{lemma} The monomorphism $h\ri K(\hat h)\of$
\[ \left(\bigvee_{\substack{i\of[n]-\set{k}\\j\of [m]-\set l}}\face(K_0(\xi),u_i\land v_j)\right)\to\left(\bigvee_{i\of[n]-\set{k}} \face(K_0(\xi),u_i)\right) \] 
has the left lifting property with respect to all fibrations.\label{left lifting property}\end{lemma}

\begin{proof}The class of morphisms with the left lifting property is closed under compositions and pushouts. The monomorphism $h\ri K(\hat h)$ belongs to this class because of this closure property.

Decompose $h\ri K(\hat h)$ as the inclusions of the following three subobjects.
\begin{align*}
A &=\dom(h\ri K(\hat h))=\left(\bigvee_{\substack{i\of[n]-\set{k}\\j\of [m]-\set l}}\face(K_0(\xi),u_i\land v_j)\right)\\
B &=\left(\bigvee_{j\of[m]-\set l}\face(K_0(\xi),u_{\xi(l)}\land v_j)\right)\vee \left(\bigvee_{i\of[n]-\set{k,\xi(l)}}\face(K_0(\xi),u_i)\right)\\
C &=\cod(h\ri K(\hat h))=\left(\bigvee_{i\of[n]-\set{k}} \face(K_0(\xi),u_i)\right)
\end{align*}

Decompose $A\to B$ as a series of inclusions $A_j\to A_{j+1}$ that satisfy $A_0=A$ and $A_{n+1}=B$ by defining $A_j$ for $j\of[n+1]$ as follows.
\[ A_j = A\vee \left(\bigvee_{i\of[j]-\set{k,j,\xi(l)}}\face(K_0(\xi),u_i)\right) \]
Each inclusion $A_j\to A_{j+1}$ is a pushout of the inclusion of $A_j\cap \face(K_0(\xi),u_{j+1})$ into $\face(K_0(\xi),u_{j+1})$, where
\begin{align*} A_j\cap \face(K_0(\xi),u_{j+1}) = &\left(\bigvee_{i\of[m]-\set l}\face(K_0(\xi),u_{j+1}\land v_{i})\right)\vee \\
&\left(\bigvee_{i\of[j+1]-\set{k,\xi(l)}}\face(K_0(\xi),u_i\land u_{j+1})\right)\end{align*}
The faces $\face(K_0(\xi),u_{j+1}\land v_{i})$ and $\face(K_0(\xi),u_i\land u_{j+1})$ all contain the point $\lambda(l)$ of $\simplex[m+\norm\xi]$ which means that lemma \ref{face completion} applies to the inclusion $A_j\land \face(K_0(\xi),u_{j+1}) \to \face(K_0(\xi),u_{j+1})$. Hence $A\to B$ has the left lifting property.

If $\xi(l)=k$, then $B=C$ and the proof is complete. Suppose $\xi(l)=i\neq k$. First define the following maps $[m+\norm\xi]\to\bool$ for each $\vec p \of\product{i\of [n]-\set k}{\xi_i}$.
\begin{align*}
w_{\vec p}(\kappa(\vec q)) &= \true &
w_{\vec p}(\lambda(q)) &= ((\xi(q)=k\vee q\leq p_{\xi(q)})\land\xi(q)\neq \xi(l))
\end{align*}

Decompose $B\to C$ as a series of inclusions $B_j\to B_j+1$ that satisfy $B_0=B$ and $B_{m+\norm\xi+1}=C$. For $j\of[m+\norm\xi+1]$ define $B_j$ as follows.
\[ B_j = B \vee \left(\bigvee_{\kappa(\vec p)<j} \face(K_0(\xi),u_{\xi(l)}\land w_{\vec p})\right)\]

When $j\neq\kappa(\vec p)$ for any $\vec p \of \product{i\of [n]-\set k}{\xi_i}$, the inclusion $B_j\to B_{j+1}$ is the identity arrow, which satsifies the left lifting property trivially. 

Suppose $j\neq\kappa(\vec p)$. Each inclusion $B_j\to B_{j+1}$ is a pushout of the inclusion of $B_j\cap \face(K_0(\xi),u_{\xi(l)}\land w_{\vec p})$ into $\face(K_0(\xi),u_{\xi(l)}\land w_{\vec p})$, where
\begin{align*} B_j\cap \face(K_0(\xi),w_{\vec p}) = 
&\bigvee_{i\of [n]-\set{\xi(l),k}}\face(K_0\xi,u_i\land w_{\vec p})\vee\\
&\bigvee_{i\of [m]-\set l} \face(K_0\xi,v_i\land w_{\vec p})\vee\\
&\bigvee_{\kappa(\vec q)<j} \face(K_0\xi,w_{\vec q}\land w_j)
\end{align*}
Let $\vec p[l]\of \product{i\of [n]-\set k}{\xi_i}$ satisfy $p[l]_j = l$ if $\xi(l)=j$ and $p[l]_i=p_i$ otherwise. The point $\kappa(p[l])$ is a member of $\face(K_0\xi,u_i\land w_{\vec p})$ for all $i\of [n]-\set{\xi(l),k}$. It is also a member of $\face(K_0\xi,w_{\vec q}\land w_{\vec p})$ for all $\vec q\of \product{i\of [n]-\set k}{\xi_i}$ such that $\kappa(\vec q)<\kappa(\vec p)$. When $\kappa(\vec p[l])$ is not a member of $\face(K_0\xi,v_i\land w_{\vec p})$ for some $i$, then $\face(K_0\xi,v_i\land w_{\vec p})$ is a subobject of a face of $B_j\cap \face(K_0(\xi),\land w_{\vec p})$ that does contain $\kappa(\vec p[l])$.

Let $i\of[m]-\set l$. If not $v_i(\kappa(\vec p[l]))$ then by definition $\xi(i)\neq k$ and $(p[l]_\xi(i) = i)$. If $i$ is the least member of $\xi_{\xi(i)}$, then $\face(K_0\xi,v_i\land w_{\vec p})\subseteq \face(K_0\xi,u_{\xi(i)}\land w_{\vec p})$. If $\xi(i-1)=\xi(i)$, then $\kappa(\vec p[i-1])<\kappa(\vec p)$ and $\face(K_0\xi,v_i\land w_{\vec p})\subseteq \face(K_0\xi,W_{\vec p[i-1]}\land w_{\vec p})$.

Since $B_j\cap \face(K_0(\xi),\land w_{\vec p})$ is a unions of faces that have the point $\vec p[l]$ in common, lemma \ref{face completion} applies to the inclusion $B_j\cap \face(K_0(\xi),\land w_{\vec p})\to \face(K_0(\xi),\land w_{\vec p})$. Therefore $B_j\to B_{j+1}$, $B\to C$ and $h\ri K(\hat h)\of A\to C$ all have the left lifting property.
\end{proof}

\begin{lemma} Let $F$ be an inhabited decidable set of faces of $\simplex[p]$ which all have a point $e$ of $\simplex[p]$ in common. The inclusion $\bigcup F\to \simplex[p]$ has the left lifting property with respect to all fibrations. \label{face completion} \end{lemma}

\begin{proof} For all $j\of[p]$ let $F_j$ be the union of $F$ with the set of $j$-dimensional faces of $\simplex[p]$ which contain the edge $e$. Because $F$ is inhabited, $\bigcup F$ contains $e$ and therefore $F_0=F$. Because $\simplex[p]$ is a $p$-dimensional face of $\simplex[p]$ which contains $e$, $\bigcup F_p = \simplex[p]$. For $j>0$ let $S_j$ be the set of $j$-dimensional faces of $\bigcup F_j$ which are not already contained in $\bigcup F_{j-1}$. A $j$-dimensional face $\face(\Sigma)$ of $\bigcup F_j$ either contains $e$ or is part of a higher dimensional face which is a member of $F$. Therefore each face $\face(\Sigma)\of S_j$ contains $e$. For this reason $\face(\Sigma)\cap \bigcup F_{j-1}$ is the horn whose central edge is $e$. The inclusion $\bigcup F_{j-1}\to\bigcup F_j$ is therefore the pushout of a coproduct of horn inclusions indexed over $S_j$. Therefore the inclusion has the left lifting property. Because composition preserves the left lifting property, $\bigcup F = F_0\to F_p = \simplex[p]$ has it too. 
\end{proof}

\end{document}