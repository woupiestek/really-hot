\documentclass[csh.tex]{subfiles}
\begin{document}

\section{Fibrations}
This section shows that fibrations are part of a factorization system as well.

\begin{lemma} Acyclic cofibrations and fibrations form an enriched factorization system on $\ambient\s\f$. \label{factorization system 2} \end{lemma}

\begin{proof} Lemma \ref{acyclic have lifting} shows that weakly invertible cofibrations (see definition \ref{weakly invertible}) are acyclic cofibrations. Lemma \ref{lifting is acyclic} shows the converse. Proposition \ref{factor2} shows that every morphism factors as a fibration following a weakly invertible cofibration.
\end{proof}

\begin{definition} Let $f,g\of X\to Y$ be a pair of morphisms of $\ambient\s$. A \keyword{homotopy} between $f$ and $g$ is a morphism $h\of \simplex[1]\times X \to Y$ such that $h\circ (k\times \id_X) = (f,g)\of 1+1 \to \simplex[1]$, where $k\of 1+1\to\simplex[1]$ is the cycle inclusion.
\[\xymatrix{
X+X \ar[dr]^{(f,g)} \ar[d]_{k\times\id}\\
\simplex[1]\times X \ar[r]_h & Y
}\]

In $\ambient\s$ a cofibration $f\of X\to Y$ is \keyword{weakly invertible} if there is a $g\of Y\to X$ such that $g\circ f = \id_X$ and a homotopy $h\of \simplex[1]\times Y\to Y$ between $f\circ g$ and $\id_Y$ such that $h\circ (\id_{\simplex[1]}\times f) = f\circ\pi_1$, where $\pi_1\of \simplex[1]\times X \to X$ is the projection.
\[\xymatrix{
Y+Y\ar[d]_{k\times \id} \ar[dr]^{(\id,f\circ g)}\\
\simplex[1]\times Y \ar[r]_(.6)h & Y\\
\simplex[1]\times X \ar[r]_(.6){\pi_1}\ar[u]^{\id\times f} & X\ar[u]_f\\
}\]
\end{definition}

\begin{lemma} Weakly invertible cofibrations are acyclic cofibrations. \label{acyclic have lifting}\end{lemma}

\begin{proof} Let $f\of X\to Y$ be a weakly invertible cofibration, with inverse $g\of Y\to X$ and homotopy $h\of\simplex[1]\times Y\to Y$. Let $k\of A\to B$ be a fibration and let $a\of X\to A$ and $b\of Y\to B$ satisfy $k\circ a=b\circ f$. The composition $a\circ g\of Y\to A$ is a filler up to homotopy, which can be transported along the homotopy $h$ to become a proper filler. Let $d_0$ be the first horn inclusion $1\to \simplex[1]$. By lemma \ref{triple lift}, there is a $d\of \simplex[1]\times Y\to A$ such that $k\circ c=b\circ h$, $c\circ (\id_{\simplex[1]}\times f)= a\circ \pi_1$ and $c\circ (d_0\times \id_Y) = a\circ g$.
Lemma \ref{triple lift} applies because the following equations hold.

\begin{align*} 
	(a\circ \pi_1)\circ (\simplex(\delta^1_1)\times\id_X) &= a = (a\circ g)\circ f\\
	(b\circ h)\circ (\simplex(\delta^1_1)\times\id_Y) &= b\circ f\circ g = k\circ (a\circ g)\\
	(b\circ h)\circ (\id_{\simplex[1]}\times f) &= b\circ f\circ \pi_1 = k\circ (a\circ \pi_1)
\end{align*}
\[\xymatrix{
X\ar[d]_f \ar[rr]^(.4){d_0\times \id} && \simplex[1]\times X \ar[d]|(.6){\id\times f}\ar[r]^(.6){a\circ \pi_1} & A\ar[d]^k\\
Y \ar[rr]_(.4){d_0\times \id}\ar[urrr]^(.3){a\circ g} && \simplex[1]\times Y\ar[r]_(.6){b\circ h}\ar@{.>}[ur]_c & B
}\]

Let $d_1$ be the other horn inclusion $1\to \simplex[1]$. Let $e=c\circ(d_1\times \id_Y)$, so $k\circ e=b\circ h\circ (d_1\times \id_Y) = b$ and $e\circ f = c\circ (\id_{\simplex[1]}\times f)\circ (d_1\times \id_X) = a$. Then $e$ is a filler for $b\circ f=k\circ a$. Since $f$ has fillers for arbitrary fibrations $k$, it is an acyclic cofibration.
\end{proof}

\begin{lemma} Let $f\of A\to B$ and $g\of C\to D$ be cofibrations and let $h\of X\to Y$ be a fibration. Let $a\of A\times D\to X$, $b\of B\times C\to X$ and $c\of B \times D\to Y$ satisfy $a\circ(\id_A\times g) = b\circ(f\times \id_C)$, $h\circ a=c\circ(f\times \id_D)$ and $h\circ b=c\circ(\id_B\times g)$. If one of $f$, $g$ or $h$ is acyclic, then there is a $d\of B\times D\to X$ such that $d\circ(f\times\id_D)=a$, $d\circ(\id_B\times g)=b$ and $h\circ d = c$.
\[\xy
(0,20)*+{A\times C}="AC",(25,20)*+{B\times C}="BC",(40,20)*+{X}="X",
(0,0)*+{A\times D}="AD",(25,0)*+{B\times D}="BD",(40,0)*+{Y}="Y"
\ar^{f\times\id} "AC";"BC"
\ar_{\id\times g} "AC";"AD"
\ar_{f\times\id} "AD";"BD"
\ar^{a} "AD";"X"
\ar|(.6){\id\times g} "BC";"BD"
\ar^(.6){b} "BC";"X"
\ar@{.>}_{d} "BD";"X"
\ar_(.6){c} "BD";"Y"
\ar^{h} "X";"Y"
\endxy\]
\label{triple lift}
\end{lemma}

\begin{proof} 
Cut down the variety of lifting problems with the following strategies.
\begin{itemize}
\item Using symmetry, derive the cases where $g$ is acyclic from those where $f$ is.
\item By definition, there is an equivalence between lifting acyclic cofibrations and having a filler for the family of horns. Use this to reduce the cases where $f$ is acyclic to the case where $f$ is the family of horns.
\item By lemma \ref{Reedy}, there is an equivalence between lifting cofibrations and having a filler for the family of cycles. Use this to reduce the cases where $g$ is an arbitrary cofibration to the case where $g$ is the family of cycles and do the same for $f$.
\end{itemize}
These reductions can be proved with the \emph{pullback power} construction and some diagram chasing.
\[\xy
(34,20)*+{X^C}="top",(0,10)*+{X^D}="left",(24,10)*+{\bullet}="middle",(44,10)*+{Y^C}="right",(34,0)*+{Y^D}="bottom"
\ar^{X^g} "left";"top" \ar@{.>}|(.6){h^{\otimes g}} "left";"middle" \ar_{h^D} "left";"bottom" \ar "middle";"bottom"
\ar "middle";"top" \ar^(.6){h^C} "top";"right" \ar_(.6){Y^g} "bottom";"right"
\endxy\]
The triple lifting problem is equivalent to the simple lifting problem of $f$ against $h^{\otimes g}$.
This leaves two tasks.
\begin{enumerate}
\item Prove that if $h$ has a filler for cycles, it has a triple filler for the cases where $f$ and $g$ are both the family of cycles.
\item Prove that if $h$ has a filler for horn, it can also handle all triple lifting problems involving the family of horns $f$ and the family of cycles $g$.
\end{enumerate}

In both cases there is a subobject of $B\times D$ that is the pushout of $f\times C$ and $A\times g$, because the underlying monomorphisms of $f$ and $g$ are decidable.

\[ f \pp g = \set{\tuplet{x,y}\of B\times D\middle| (x\of f(A)) \vee (y\of g(C)) }\]
Since pushouts preserve left lifting properties, a filler for the inclusion $f\pp g \to B\times D$ is sufficient.

For $m > 0$ and $n > 0$ none of the faces of $\simplex[m]\times \simplex[n]$ belong to either $\simplex[m]\times \cycle[n]$ or $\horn_k[m]\times\simplex[n]$ for any $k\of[m]$, because the faces are $m+n$-dimensional and the faces of either $\simplex[m]$ or $\simplex[n]$ are not. The cases where $m=0$ or $n=0$ are trivial because $\simplex[0] \simeq 1$, $\cycle[0]\simeq 0$ and $\horn_0[0]$ does not exist. Since the inclusion $f\pp g \to B\times D$ is a countable sum of these inclusions, it is a cofibration. This settles the case where both $f$ and $g$ are the family of cycle inclusions, because $h$ is an acyclic fibration.

The case where $f$ is the family of horn inclusions is more complicated. Fortunately, this case is worked out in the proof of lemma A.1 in \citep{DD&DIS11}, where \emph{inner anodyne} is what this paper calls acyclic and \emph{box product} is the $\pp$ operator in $f\pp g$ above. Note that all necessary properties of simplices are decidable. Since the inclusion $f\pp g\to B\times D$ is an acyclic cofibration, $h$ provides a filler.
\end{proof}
\hide{perhaps we should adopt the same terms as that paper.}

\hide{
\begin{lemma} Let $f\of A\to B$ and $g\of C\to D$ be cofibrations and let $h\of X\to Y$ be a fibration. Let $a\of A\times D\to X$, $b\of B\times C\to X$ and $c\of B \times D\to Y$ satisfy $a\circ(\id_A\times g) = b\circ(f\times \id_C)$, $h\circ a=c\circ(f\times \id_D)$ and $h\circ b=c\circ(\id_B\times g)$. If one of $f$, $g$ or $h$ is acyclic, then there is a $d\of B\times D\to X$ such that $d\circ(f\times\id_D)=a$, $d\circ(\id_B\times g)=b$ and $h\circ d = c$.
\[\xy
(0,20)*+{A\times C}="AC",(25,20)*+{B\times C}="BC",(40,20)*+{X}="X",
(0,0)*+{A\times D}="AD",(25,0)*+{B\times D}="BD",(40,0)*+{Y}="Y"
\ar^{f\times\id} "AC";"BC"
\ar_{\id\times g} "AC";"AD"
\ar_{f\times\id} "AD";"BD"
\ar^{a} "AD";"X"
\ar|(.6){\id\times g} "BC";"BD"
\ar^(.6){b} "BC";"X"
\ar@{.>}_{d} "BD";"X"
\ar_(.6){c} "BD";"Y"
\ar^{h} "X";"Y"
\endxy\]
\label{triple lift}
\end{lemma}

\begin{proof} The general case reduces to the cases where $f$ and $g$ are cycle or horn inclusions, because the lemma is equivalent to the statement that the following maps $\tuplet{f\to h}$ and $\tuplet{g\to h}$ are (acyclic) fibrations and because acyclic fibrations are contractible (see definition \ref{contractible}).
\begin{align*}
\tuplet{f\to h}&=\tuplet{h^{\id_B},\id_X^f}\of X^B \to Y^B\times_{Y^A} X^A\\
\tuplet{g\to h}&=\tuplet{h^{\id_D},\id_X^g}\of X^D \to Y^D\times_{Y^C} X^C
\end{align*}
In the case where $h$ is an acyclic fibration the morphism $\tuplet{g\to h}$ is an acyclic fibration if is has the lifting property for the family of cycle inclusions $k_i\of \cycle[i]\to\simplex[i]$ for $i\of\nno$, because acyclic fibrations are contractible morphisms (see lemma \ref{Reedy}). In turn $\tuplet{k_n\to h}$ are acyclic cofibrations if the triple lifting property holds in the cases where $a=k_i$ and $b=k_j$ for all $i,j\of\nno$.

For the cases where $f$ or $g$ are acyclic the same reduction takes us to products of cycle and horn inclusions. If $f$ is acyclic, the problem of lifting $f$ against $g\to h$ reduces to the problem of lifting horn inclusions. The problem of lifting a possibly not acyclic $g$ against $k\to h$, where $k$ is a horn inclusion, reduces to the problem of lifting cycle inclusions by lemma \ref{Reedy}.

In the cases where $f$ and $g$ are horn or cycle inclusions it is easy to prove that their pushout products $g\pp f$ are compositions of pushouts of sums of horns and cycles and therefore have the left lifting properties with respect to (acyclic) fibrations (see lemma \ref{saturation}).
\[\xy
(0,10)*+{W\times Y}="left",(20,10)*+{\bullet}="middle",(10,20)*+{X\times Y}="top",(10,0)*+{W\times Z}="bottom",(40,10)*+{X\times Z}="right"
\ar^(.4){f\times \id} "left";"top" \ar_{\id\times g} "left";"bottom" \ar "top";"middle" \ar "bottom";"middle"
\ar@{.>}|(.3){g\pp f} "middle";"right" \ar^{\id\times g} "top";"right" \ar_{f\times\id} "bottom";"right"
\endxy\]
Therefore the lemma holds for every pair of cofibrations $f$, $g$ as long as one of $f$, $g$ and $h$ is acyclic.
\end{proof}
}

\begin{lemma} All acyclic cofibrations in $\ambient\s\f$ are weakly invertible cofibrations.\label{lifting is acyclic} \end{lemma}

\begin{proof} An acyclic fibration is a fibration, because the right lifting property for cofibrations implies the right lifting property for the family of horn inclusions. Therefore every acyclic cofibration is a cofibration.

Let $f\of X\to Y$ be a morphism with the left lifting property for all fibrations in $\ambient\s\f$. There is a morphism $g\of Y\to X$ such that $g\circ f = \id_X$ because $X$ is fibrant. 
\[ \xymatrix{
X\ar[d]_f \ar[r]^\id & X\ar[d]^\bang\\
Y\ar[r]_\bang \ar@{.>}[ur]_h & 1
}\]
There is a morphism $h\of \simplex[1]\times Y\to Y$ such that $h\circ k = (\id_Y,f\circ g)$ if $k\of 1+1\to\simplex[1]$ is the cycle inclusion and $h\circ (\id_{\simplex[1]}\times f) = f\circ\pi_1$ because $Y$ is fibrant and because of lemma \ref{triple lift}.
\[ \xymatrix{
X+X\ar[d]_{f+f}\ar[r]^{k\times\id} & \simplex[1]\times X \ar[r]^(.6){f\circ \pi_0}\ar[d] & Y\ar[d]^\bang\\
Y+Y\ar[r]_{k\times\id} \ar[urr]^(.3){(\id,g)} & \simplex[1]\times Y \ar[r]_\bang\ar@{.>}[ur]_h & 1
}\]
Therefore $f$ is a weakly invertible cofibration by definition \ref{weakly invertible}.
\end{proof}

\begin{proposition} Every morphism $f\of X\to Y$ of $\ambient\s\f$ factors as a fibration following a weakly invertible cofibration. \label{factor2} \end{proposition}

\begin{proof} Define $Y/f$, $p_0\of Y/f\to Y$ and $r\of X\to Y/f$ as follows. 
\begin{align*}
Y/f &= \set{\tuplet{x,p}\of X\times Y^{\simplex[1]}\middle| f(x) = p(\function{*}{1}) }\\
p_0\tuplet{x,p} &= p(\function{*}{0})\\
r(x) &= \tuplet{x,\function{*}{f(x)}}
\end{align*}

The morphism $r$ is not necessarily a cofibration, but factors as an acyclic fibration $g\of W\to Y/f$ following a cofibration $h\of X\to W$ by proposition \ref{factor1}. The morphism $h$ is a weakly invertible cofibration and the composition $p_0\circ g$ is a fibration for the following reasons.

%h is ac
There is a morphism $p_1\of Y/f\to X$ that satisfies $p_1\tuplet{x,p}=x$. Let $h'=p_1\circ h$, so $h'\circ h = \id_X$.
There is a homotopy $\phi$ between $\id_{W}$ and $h\circ h'$ by lemma \ref{triple lift} and the following equations.
\begin{align*}
(\id_W,h\circ h')\circ(h+h)&=(h,h)= (h\circ\pi_1)\circ (c\times \id_X)\\
h'\circ h\circ \pi_1&=\pi_1=(h'\circ\pi_1)\circ(\id_{\simplex[1]}\times h)\\
h'\circ(\id_W,h\circ h')&=(h',h')= (h'\circ\pi_1)\circ (c\times \id_W)
\end{align*}
\[\xymatrix{
X+X\ar[d]_{c\times \id}\ar[r]^{h+h} & W+W\ar[d]_(.3){c\times \id}\ar[r]^(.6){(\id,h\circ h')} & W\ar[d]^{h'}\\
\simplex[1]\times X\ar[r]_{\id\times h} \ar[urr]^(.3){h\circ\pi_1}  & \simplex[1]\times W\ar[r]_(.6){h'\circ\pi_1} \ar@{.>}[ur]_\phi & X
}\]
Because $\phi\circ(\id_{\simplex[1]\times h}) = h\circ \pi_1$, the cofibration $h$ is weakly invertible by definition \ref{weakly invertible}. 
%p_0\circ g is fib

Since fibrations are closed under composition and since $g$ is an acyclic fibration, $p_0\circ g$ is a fibration if $p_0$ is. Let $d\of A\to B$ be a weakly invertible cofibration and let $a\of A\to Y/f$ and $b\of B\to Y$ satisfy $p_0\circ a = b\circ d$. There is a morphism $c_0\of B\to X$ such that $c_0\circ d = p_1\circ a$ because $X$ is fibrant. Let $e_0$ be one of the horn inclusions $1\to \simplex[1]$. There is a morphism $c_1\of\simplex[1]\times B\to Y$ such that $c_1\circ{(\id_{\simplex[1]}\times d)}$ is the transpose of $p_0\circ a$ and $c_0\circ (e_0\times \id_B) = f\circ c_1$ because $Y$ is fibrant and because of lemma \ref{triple lift}.
\[\xy
(0,20)*+{A}="AC",(25,20)*+{\simplex[1]\times A}="BC",(50,20)*+{Y}="Y",
(0,0)*+{B}="AD",(25,0)*+{\simplex[1]\times B}="BD",(50,0)*+{1}="one"
\ar^(.4){e_0\times\id} "AC";"BC"
\ar_{d} "AC";"AD"
\ar_(.4){e_0\times\id} "AD";"BD"
\ar^(.3){f\circ c_0} "AD";"Y"
\ar|(.3){\id\times d} "BC";"BD"
\ar^(.6){a^t} "BC";"Y"
\ar@{.>}_{c_1} "BD";"Y"
\ar_(.6){\bang} "BD";"one"
\ar^{\bang} "Y";"one"
\endxy\]
The transpose $c_1^t\of B\to Y^{\simplex[1]}$ of $c_1$ and $c_0$ together factor as a morphism $c\of B \to Y/f$ which is a filler for $p_0\circ a = b\circ d$. Generalizing, $p_0$ has the right lifting property with respect to all acyclic cofibrations and therefore is a fibration.
\end{proof}

\end{document}