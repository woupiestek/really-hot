\documentclass[12pt,a4paper]{article}
\usepackage{amsmath, amssymb, amsthm}
\usepackage[all]{xy}
\usepackage{stmaryrd}

\title{The recursive realizability of homotopy type theory}
\author{Wouter Stekelenburg}
\date{}

\newtheorem*{thes}{Thesis}
\newtheorem*{thm}{Theorem}

\theoremstyle{definition}
\newtheorem*{defin}{Definition}

\newcommand\hide[1]{}


\newenvironment{blackboard}{\begin{tabular}{|p{350pt}|}\hline} {\\ \hline \end{tabular} }

\begin{document}\maketitle

Recursive realizability is the oldest model of Heyting arithmetic which does not satisfy classical logic. The effective topos extends recursive realizability to higher order constructive logic. This talk is about similar extensions to (homotopy) type theory.

The model category is the category internal groupoids of the effective topos. Because the effective topos has enough projectives, there is a projective model structure on these groupoids, whose weak equivalences are essentially surjective in the internal language of the topos.

The subcategory of $\neg\neg$-separated objects has a complete internal category -- the category of modest sets -- which offers a universe of small 1-types.

\section{background}
In recursive realizability every proposition has a set of realizers. The realizers encode information for why the proposition is valid, using recursive encodings. It is an implementation of the Brouwer-Heyting-Kolmorgorow interpretation.

The effective topos is a form of recursive realizability, because it assigns a set of realizers to each proposition of its internal language. In the following presentation of the effective topos, \emph{none} of this will be apparent. Instead I will focus on properties that are relevant to the model structure, namely:

\newcommand\Set{\mathsf{Set}}
\newcommand\Eff{\mathsf{Eff}}
\begin{itemize}
\item the projective objects.
\item the separated objects.
\item the modest sets.
\end{itemize}

\subsection{projectives}
The effective topos has enough projectives. A projective object has the lifting property with regard to epimorphisms and enough projectives means that for each object $X$ there is a projective $P$ and an epimorphisms $e:P\to X$.

Because the effective topos has finite coproducts, there is a (weak) factorisation system where the left class of morphisms contains all inclusions in coproducts with projectives $X\to X+P$.

Note that the effective topos has no infinite colimits!

\begin{blackboard}
Projectives; Projective-epimorphic factorisation
\[ \xymatrix{
& X\ar[d]^e\\
P \ar@{.>}[ur]\ar[r] & Y
}\qquad\xymatrix{
X\ar[rr]^f\ar[dr]_{\iota_0} && Y \\
& X+P \ar[ur]^{(f,e)} & P\ar[u]_e\ar[l]^(.3){\iota_1}
}\]
\end{blackboard}

\subsection{separated objects}
As in any topos, double negation is a local operator or Lawvere-Tierney topology. The category of sheaves for this local operator is equivalent to the topos of sets. 

\newcommand\Asm{\mathsf{Asm}}
The \emph{$\neg\neg$-separated objects} are objects for which the diagonal is closed. These form a subcategory of the effective topos that contain the topos of sets.

The natural number object of the effective topos is separated and hence in this subcategory.

The category of separated objects is regular and its inclusion to the effective topos is regular too.

Finaly separated objects also cover all objects of the effective topos and this causes projective objects to be separated.

\begin{blackboard}
Separated objects.
\begin{itemize}
\item $\neg\neg:\Omega \to \Omega$ 
\item $\mathsf{Sh}(\Eff,\neg\neg)\cong\Set$

The inclusion $\nabla:\Set \to \Eff$ is right adjoint ot the global sections functor $\Gamma:\Eff \to \Set$ contra to Grothendieck toposes.

\item $\Set \to \Asm \to \Eff$
\item $\Asm$ and inclusion $\Asm\to \Eff$ are regular

consequence: $\neg\neg(\exists x.\phi)\to \exists x.\neg\neg\phi$.

\item $N\in \Asm$
\end{itemize}

Separated cover $e:S \to P$ has section $s:P\to A$, but subobjects of separated objects are separated.
\end{blackboard}

\subsection{discrete arrows and modest sets}
A \emph{prone epimorphism} is an epimorphism which is prone (or cartesian) relative to the global sections functor -- which is a fibration.
A morphism is \emph{discrete} if it is right orthogonal to a prone epimorphism. All monomorphisms are discrete because the left class consist of epimorphisms. Since they are also a saturated class, discrete morphisms form a complete fibration and in fact a complete stack on the effective topos.

\begin{blackboard}
\[\xymatrix{
X\ar[r]^e\ar[d]_{\eta_X}\ar@{}[dr]|<\lrcorner & Y\ar[d]^{\eta_Y}\\
\nabla\Gamma X\ar[r]_{\nabla\Gamma e} & \nabla\Gamma Y
}\qquad
\xymatrix{
A\ar[r]\ar[d]_{\textrm{prone epi.}} & B\ar[d]^{\textrm{discete}}\\
C\ar[r]\ar@{.>}[ur] & D
}
\]

Mono's are discrete and discretes are saturated. As consequence, discretes have all finite limits and indexed products.
\end{blackboard}

Discrete objects coinside with quotients of the natural number object. Because we are in a topos, there is a bundle and even an internal category of such subquotients. 
\hide{laat zien wat je bedoelt}
Thus discrete objects form a kind of complete internal category. Unfortunately, dependent products only preserve subquotients of $N$ along morphisms whose codomain is separated. Nonetheless, this enough to force such morphisms to factorize as a discrete morphism following a prone epimorphism.

\begin{blackboard}
The category of discrete objects is essentially internal. There is an equivalence with \emph{partial equivalence relations} on the natural numbers.
\[ D \leftarrow \cdot \rightarrow N\quad \coprod_{R\in \mathsf{PER}} N/R \to \mathsf{PER} \]

For $f:X\to Y$, the dependent products $\prod_f:\Eff/X\to \Eff/Y$ preserves subquotients of $N$ iff $Y$ is separated.

Result: every morphism with separated domain has prone epi. - discrete factorisation.
\xymatrix{
X\ar[rr]^f\ar[dr]_{\textrm{prone epi.}} && Y \\
& Z \ar[ur]_{\textrm{discrete}}
}
\end{blackboard}

The object of $\neg\neg$-stable truth values is itself $\neg\neg$-separated. In fact is is isomorphic to $\nabla 2$. 
For this reason, the separated discrete objects -- called \emph{modest sets} -- \emph{do} form a complete internal category of the category of separated objects.
The combination of completeness and internalness implies that modest sets from a cocomplete stack over the category of assemblies.

\begin{blackboard} $\Omega_{\neg\neg} = \nabla 2$. Modest set is separated discrete object. Bundle of modest sets plus internal completeness gives internal cocompleteness. \end{blackboard}

\section{projective model structure}
I will now introduce the projective model structure on the category of internal groupoids in the category of separated objects $\Asm$.
The canonical model structure on groupoids has functors that are injective on object as cofibrations, fully faithfull eso functor as weak equivalences and Grothendieck fibrations as fibrations. This doesn't work well for groupoids in the effective topos, because classical logic fail there, so the required liftings don't exist.

The interpretation of weak equivalence is a bit more subtle. Even though the effective topos has fewer limits and violates classical logic, the usual construction still suffices to factorize a functor $f$ as an equivalence $g$ followed by a (iso)fibration $h$.
Now $f$ is 'essentially surjective' if $h$ is an epimorphism on objects.This define both the class of fibrations and the class of trivial fribrations of the projective model structure. At this point $g$ is a weak equivalence but not necessarily a cofibration.

\begin{blackboard}
Projective model structure.

\[ \xymatrix{
X\ar[rr]^f\ar[dr]_g && Y\\
& Y\downarrow f \ar[ur]_h
}\]

\begin{itemize}
\item Fibration is Grothendieck fibration.
\item Trivial fibration is fully faithful and epi on objects.
\item Weak equivalences include functors with weak inverses.
\end{itemize}
\end{blackboard}


The projective-epimorphism factorisation system lifts to a factorisation system on functors. The left class consists of functors which are `projective on objects' and the right class of fully faithful functors which are epimorphic on object, precisely the trivial fibrations of the model structure.

\begin{blackboard}
\[ \xymatrix{
A\ar[rr]\ar[dr]_{\textrm{po}} && B\\
& C \ar[ur]_{\textrm{eo}}
}\]
\end{blackboard}

In the factorisation above, $g$ is trivial, but not neccesarily projective on objects. We fix this by factoring $g$ as a cofibraion followed be a trival fibration. The cofibration part is a weak equivalence by 2-out-of-3.

\begin{blackboard}
\[ \xymatrix{
X\ar[rr]^f\ar[dr]_g \ar[d]_{\textrm{po}} && Y\\
Z \ar[r]_{\textrm{eo}} & Y\downarrow f \ar[ur]_h
}\]

Thus we get a model structure where
\begin{itemize}
\item cofibrations are `projective on objects'.
\item weak equivalences are fully faithful and `essentially epic on objects'.
\item fibrations are Grothendieck (iso)fibrations.
\end{itemize}
\end{blackboard}

\section{the univalent fibration}
There are some problems with the definition of equivalences. I will treat those later because I want to explain what the univalent firbation is supposed to be first. The univalent fibration comes form the bundle of modest sets is pretty straighforward. We turn the modest sets into discrete groupoids, so that equivalent modest sets are trivially isomorphic.
Let $P$ be the groupoid of PERs and their isomorphisms and $P^*$ the groupoid of pointed pers and their isomorphisms. There is a forgetful functor $P^*\to P$ and this is a univalnet fibration for trivial reasons.

\[ P^* \to P \]

\section{equivalences}
The existence of a weak equivalence $X\to Y$ is not an equivalence relation, because some weak equivalence have no weak inverses. Instead groupoids $X$ and $Y$ are already weakly equivalence is defined by spans of equivalences if there is a third groupoid $Z$ and equivalences $f:Z\to X$ and $g:Z\to Y$, otherwise the relation won't be symmetric. We don't have to look further than such spans, because they combine with pullbacks and factorisations, but that still leaves a proper class of spans between $X$ and $Y$.

\begin{blackboard}
\[\xymatrix{ & Z\ar[dl]^f\ar[dr]^g \\ X&& Y }\] 
\end{blackboard}

Now we take advantage of the factorisation of each morphism into modest morphism following a prone epimorphism in the category of separated objects. The prone epimorphism all have a section and therefore a weak inverse. Hence every span of equivalences factors through a span where at least one of the equivalences is discrete on objects. The objects of spans of equivalences where one of the equivalences is modest on objects, is represented in the the catgeory of assemblies thanks to the universal bundle of modest sets.

\begin{blackboard}
\[\xymatrix{ W\ar[d]_{\textrm{disc.}}\ar@/^/[r] & Z\ar[l]^{\textrm{pe}}\ar[dl]^f\ar[dr]^g \\ X&& Y }\] 
\end{blackboard}

There are some extra considerations which make life even easier:
\begin{itemize}
\item all groupoids are fibrant in the projective model structure, so we can retrict to trivial fibrations for the equivalences.
\item we only have to consider projective discrete objects and these are with $\neg\neg$-stable sets of numbers.
\end{itemize}


\section{ideas, questions}
The objects of the effective topos are represented in the category of assmblies as groupoids and the represnetations are weakly equivalent. The homotopy catgeory should therefore be an extended edition of the effective topos. The questions here are: Is this stil a topos? Are equivariant families of modest sets a complete category now?

I think it is possible to extend all of this stucture to higher groupoids, possibly by working with some model structure on simplicial objects in the category of simpicial separated objects.

\end{document}